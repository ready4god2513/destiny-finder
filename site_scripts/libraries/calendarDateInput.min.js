/***********************************************
 Fool-Proof Date Input Script with DHTML Calendar
 by Jason Moon - http://calendar.moonscript.com/dateinput.cfm
 ************************************************/// Customizable variables
function YearDigitsOnly(a){var b=a.keyCode?a.keyCode:a.which;return b==8||b==9||b==37||b==39||b==46||b>47&&b<58}function GetTagPixels(a,b){var c=b=="LEFT"?a.offsetLeft:a.offsetTop;while(a.tagName!="BODY"&&a.tagName!="HTML")a=a.offsetParent,c+=b=="LEFT"?a.offsetLeft:a.offsetTop;return c}function BehindCal(a,b,c,d,e,f){var g=GetTagPixels(a,"LEFT"),h=g+a.offsetWidth,i=f+a.offsetHeight;return f<e&&i>d&&g<c&&h>b}function FixSelectLists(a){if(navigator.appName=="Microsoft Internet Explorer"){var b=this.getCalendar(),c=b.offsetLeft,d=c+b.offsetWidth,e=b.offsetTop,f=e+CellHeight*9,g=!1;h:for(var i=this.formNumber;i<document.forms.length;i++)for(var j=0;j<document.forms[i].elements.length;j++)if(typeof document.forms[i].elements[j].type=="string"){document.forms[i].elements[j].type=="hidden"&&document.forms[i].elements[j].name==this.hiddenFieldName&&(g=!0,j+=3);if(g&&document.forms[i].elements[j].type.substr(0,6)=="select"){ListTopY=GetTagPixels(document.forms[i].elements[j],"TOP");if(ListTopY<f)BehindCal(document.forms[i].elements[j],c,d,e,f,ListTopY)&&(document.forms[i].elements[j].style.visibility=a?"hidden":"visible");else break h}}}}function DayCellHover(a,b,c,d){a.style.backgroundColor=b?DayBGColor:c;if(b)if(this.yearValue==Today.getFullYear()&&this.monthIndex==Today.getMonth()&&d==Today.getDate())self.status="Click to select today";else{var e=d.toString();switch(e.substr(e.length-1,1)){case"1":e+=d==11?"th":"st";break;case"2":e+=d==12?"th":"nd";break;case"3":e+=d==13?"th":"rd";break;default:e+="th"}self.status="Click to select "+this.monthName+" "+e}else self.status="";return!0}function PickDisplayDay(a){this.show();var b=this.getMonthList(),c=this.getDayList(),d=this.getYearField();FixDayList(c,GetDayCount(this.displayed.yearValue,this.displayed.monthIndex));for(var e=0;e<b.length;e++)b.options[e].value==this.displayed.monthIndex&&(b.options[e].selected=!0);for(var f=1;f<=c.length;f++)f==a&&(c.options[f-1].selected=!0);this.setPicked(this.displayed.yearValue,this.displayed.monthIndex,a),d.value=this.picked.yearPad,d.defaultValue=d.value}function BuildCalendarDays(){var a=5;this.displayed.dayCount==31&&this.displayed.firstDay>4||this.displayed.dayCount==30&&this.displayed.firstDay==6?a=6:this.displayed.dayCount==28&&this.displayed.firstDay==0&&(a=4);var b='<table width="'+CellWidth*7+'" cellspacing="0" cellpadding="1" style="cursor:default">';for(var c=0;c<a;c++){b+="<tr>";for(var d=1;d<=7;d++)Day=c*7+(d-this.displayed.firstDay),Day>=1&&Day<=this.displayed.dayCount?(this.displayed.yearValue==this.picked.yearValue&&this.displayed.monthIndex==this.picked.monthIndex&&Day==this.picked.day?(TextStyle="color:white;font-weight:bold;",BackColor=DayBGColor):(TextStyle="color:black;",BackColor=CalBGColor),this.displayed.yearValue==Today.getFullYear()&&this.displayed.monthIndex==Today.getMonth()&&Day==Today.getDate()&&(TextStyle+="border:1px solid darkred;padding:0px;"),b+='<td align="center" class="calendarDateInput" style="cursor:default;height:'+CellHeight+";width:"+CellWidth+";"+TextStyle+";background-color:"+BackColor+'" onClick="'+this.objName+".pickDay("+Day+')" onMouseOver="return '+this.objName+".displayed.dayHover(this,true,'"+BackColor+"',"+Day+')" onMouseOut="return '+this.objName+".displayed.dayHover(this,false,'"+BackColor+"')\">"+Day+"</td>"):b+='<td class="calendarDateInput" style="height:'+CellHeight+'">&nbsp;</td>';b+="</tr>"}return b+="</table>"}function GetGoodYear(a){if(a.length==4)return a;var b=a<Y2kPivotPoint?2e3:1900;return b+parseInt(a,10)}function GetDayCount(a,b){return b==1&&(a%400==0||a%4==0&&a%100!=0)?29:MonthDays[b]}function VirtualButton(a,b){b?(a.style.borderLeft="buttonshadow 1px solid",a.style.borderTop="buttonshadow 1px solid",a.style.borderBottom="buttonhighlight 1px solid",a.style.borderRight="buttonhighlight 1px solid"):(a.style.borderLeft="buttonhighlight 1px solid",a.style.borderTop="buttonhighlight 1px solid",a.style.borderBottom="buttonshadow 1px solid",a.style.borderRight="buttonshadow 1px solid")}function NeighborHover(a,b,c){return b?(VirtualButton(a,!1),self.status="Click to view "+c.fullName):(a.style.border="buttonface 1px solid",self.status=""),!0}function FixDayList(a,b){var c=a.selectedIndex+1;if(b!=a.length){var d=a.length;for(var e=Math.min(b,d);e<Math.max(b,d);e++)e>=b?a.options[b]=null:a.options[e]=new Option(e+1,e+1);c=Math.min(c,b),a.options[c-1].selected=!0}return c}function FixYearInput(a){var b=new RegExp("\\d{"+a.defaultValue.length+"}");b.test(a.value)||(a.value=a.defaultValue)}function CalIconHover(a){var b=this.isShowing()?"hide":"show";return self.status=a?"Click to "+b+" the calendar":"",!0}function CalTimerReset(){eval("clearTimeout("+this.timerID+")"),eval(this.timerID+"=setTimeout('"+this.objName+".show()',"+HideWait*1e3+")")}function DoTimer(CancelTimer){CancelTimer?eval("clearTimeout("+this.timerID+")"):(eval(this.timerID+"=null"),this.resetTimer())}function ShowCalendar(){if(this.isShowing()){var a=!0;this.getCalendar().style.zIndex=--ZCounter,this.getCalendar().style.visibility="hidden",this.fixSelects(!1)}else{var a=!1;this.fixSelects(!0),this.getCalendar().style.zIndex=++ZCounter,this.getCalendar().style.visibility="visible"}this.handleTimer(a),self.status=""}function SetElementStatus(a){this.getDayList().style.visibility=a?"hidden":"visible",this.getYearField().style.visibility=a?"hidden":"visible",this.getCalendarLink().style.visibility=a?"hidden":"visible"}function CheckMonthChange(a){var b=this.getDayList();if(a.options[a.selectedIndex].value=="")b.selectedIndex=0,this.hideElements(!0),this.setHidden("");else{this.hideElements(!1),this.isShowing()&&(this.resetTimer(),this.getCalendar().style.zIndex=++ZCounter);var c=FixDayList(b,GetDayCount(this.picked.yearValue,a.options[a.selectedIndex].value));this.setPicked(this.picked.yearValue,a.options[a.selectedIndex].value,c)}}function CheckDayChange(a){this.isShowing()&&this.show(),this.setPicked(this.picked.yearValue,this.picked.monthIndex,a.selectedIndex+1)}function CheckYearInput(a){if(a.value.length==a.defaultValue.length&&a.defaultValue!=a.value){this.isShowing()&&(this.resetTimer(),this.getCalendar().style.zIndex=++ZCounter);var b=GetGoodYear(a.value),c=this.getMonthList(),d=FixDayList(this.getDayList(),GetDayCount(b,this.picked.monthIndex));this.setPicked(b,this.picked.monthIndex,d),a.defaultValue=a.value}}function dateObject(){if(Function.call)var a=this,b=0;else var a=arguments[0],b=1;a.date=arguments.length==b+1?new Date(arguments[b+0]):new Date(arguments[b+0],arguments[b+1],arguments[b+2]),a.yearValue=a.date.getFullYear(),a.monthIndex=a.date.getMonth(),a.monthName=MonthNames[a.monthIndex],a.fullName=a.monthName+" "+a.yearValue,a.day=a.date.getDate(),a.dayCount=GetDayCount(a.yearValue,a.monthIndex);var c=new Date(a.yearValue,a.monthIndex,1);a.firstDay=c.getDay()}function storedMonthObject(a,b,c,d){Function.call?dateObject.call(this,b,c,d):dateObject(this,b,c,d),this.yearPad=this.yearValue.toString(),this.monthPad=this.monthIndex<9?"0"+String(this.monthIndex+1):this.monthIndex+1,this.dayPad=this.day<10?"0"+this.day.toString():this.day,this.monthShort=this.monthName.substr(0,3).toUpperCase(),a.indexOf("YYYY")==-1&&(this.yearPad=this.yearPad.substr(2));if(a.indexOf("/")>=0)var e="/";else if(a.indexOf("-")>=0)var e="-";else var e="";/DD?.?((MON)|(MM?M?))/.test(a)?(this.formatted=this.dayPad+e,this.formatted+=RegExp.$1.length==3?this.monthShort:this.monthPad):/((MON)|(MM?M?))?.?DD?/.test(a)&&(this.formatted=RegExp.$1.length==3?this.monthShort:this.monthPad,this.formatted+=e+this.dayPad),this.formatted=a.substr(0,2)=="YY"?this.yearPad+e+this.formatted:this.formatted+e+this.yearPad}function displayMonthObject(a,b,c,d){Function.call?dateObject.call(this,b,c,d):dateObject(this,b,c,d),this.displayID=a.hiddenFieldName+"_Current_ID",this.getDisplay=new Function("return document.getElementById(this.displayID)"),this.dayHover=DayCellHover,this.goCurrent=new Function(a.objName+".getCalendar().style.zIndex=++ZCounter;"+a.objName+".setDisplayed(Today.getFullYear(),Today.getMonth());"),a.formNumber>=0&&(this.getDisplay().innerHTML=this.fullName)}function neighborMonthObject(a,b,c){Function.call?dateObject.call(this,c):dateObject(this,c),this.buttonID=a.hiddenFieldName+"_"+b+"_ID",this.hover=new Function("C","O","NeighborHover(C,O,this)"),this.getButton=new Function("return document.getElementById(this.buttonID)"),this.go=new Function(a.objName+".getCalendar().style.zIndex=++ZCounter;"+a.objName+".setDisplayed(this.yearValue,this.monthIndex);"),a.formNumber>=0&&(this.getButton().title=this.monthName)}function SetDisplayedMonth(a,b){this.displayed=new displayMonthObject(this,a,b,1),this.previous=new neighborMonthObject(this,"Previous",this.displayed.date.getTime()-864e5),this.next=new neighborMonthObject(this,"Next",this.displayed.date.getTime()+864e5*(this.displayed.dayCount+1)),this.formNumber>=0&&(this.getDayTable().innerHTML=this.buildCalendar())}function SetPickedMonth(a,b,c){this.picked=new storedMonthObject(this.format,a,b,c),this.setHidden(this.picked.formatted),this.setDisplayed(a,b)}function calendarObject(a,b,c){function d(a){for(var b=0;b<MonthNames.length;b++)if(MonthNames[b].substr(0,3).toUpperCase()==a.toUpperCase())break;return b}function e(a,d){a.setPicked(Today.getFullYear(),Today.getMonth(),Today.getDate()),d&&alert("WARNING: The supplied date is not in valid '"+b+"' format: "+c+".\nTherefore, the current system date will be used instead: "+a.picked.formatted)}this.hiddenFieldName=a,this.monthListID=a+"_Month_ID",this.dayListID=a+"_Day_ID",this.yearFieldID=a+"_Year_ID",this.monthDisplayID=a+"_Current_ID",this.calendarID=a+"_ID",this.dayTableID=a+"_DayTable_ID",this.calendarLinkID=this.calendarID+"_Link",this.timerID=this.calendarID+"_Timer",this.objName=a+"_Object",this.format=b,this.formNumber=-1,this.picked=null,this.displayed=null,this.previous=null,this.next=null,this.setPicked=SetPickedMonth,this.setDisplayed=SetDisplayedMonth,this.checkYear=CheckYearInput,this.fixYear=FixYearInput,this.changeMonth=CheckMonthChange,this.changeDay=CheckDayChange,this.resetTimer=CalTimerReset,this.hideElements=SetElementStatus,this.show=ShowCalendar,this.handleTimer=DoTimer,this.iconHover=CalIconHover,this.buildCalendar=BuildCalendarDays,this.pickDay=PickDisplayDay,this.fixSelects=FixSelectLists,this.setHidden=new Function("D","if (this.formNumber >= 0) this.getHiddenField().value=D"),this.getHiddenField=new Function("return document.forms[this.formNumber].elements[this.hiddenFieldName]"),this.getMonthList=new Function("return document.getElementById(this.monthListID)"),this.getDayList=new Function("return document.getElementById(this.dayListID)"),this.getYearField=new Function("return document.getElementById(this.yearFieldID)"),this.getCalendar=new Function("return document.getElementById(this.calendarID)"),this.getDayTable=new Function("return document.getElementById(this.dayTableID)"),this.getCalendarLink=new Function("return document.getElementById(this.calendarLinkID)"),this.getMonthDisplay=new Function("return document.getElementById(this.monthDisplayID)"),this.isShowing=new Function("return !(this.getCalendar().style.visibility != 'visible')");if(c!="")if(this.format=="YYYYMMDD"&&/^(\d{4})(\d{2})(\d{2})$/.test(c))this.setPicked(RegExp.$1,parseInt(RegExp.$2,10)-1,RegExp.$3);else if(this.format.substr(0,2)=="YY"&&/^(\d{2,4})(-|\/)/.test(c)){var f=GetGoodYear(RegExp.$1);if(/(-|\/)(\w{1,3})(-|\/)(\w{1,3})$/.test(c)){var g=RegExp.$2,h=RegExp.$4;if(/D$/.test(this.format))var i=h,j=g;else var i=g,j=h;j=/\d{1,2}/i.test(j)?parseInt(j,10)-1:d(j),this.setPicked(f,j,i)}else e(this,!0)}else if(/(-|\/)(\d{2,4})$/.test(c)){var f=GetGoodYear(RegExp.$2);if(/^(\w{1,3})(-|\/)(\w{1,3})(-|\/)/.test(c)){if(this.format.substr(0,1)=="D")var i=RegExp.$1,j=RegExp.$3;else var j=RegExp.$1,i=RegExp.$3;j=/\d{1,2}/i.test(j)?parseInt(j,10)-1:d(j),this.setPicked(f,j,i)}else e(this,!0)}else e(this,!0)}function DateInput(DateName,Required,DateFormat,DefaultDate){if(arguments.length==0)document.writeln('<span style="color:red;font-size:'+FontSize+"px;font-family:"+FontFamily+";\">ERROR: Missing required parameter in call to 'DateInput': [name of hidden date field].</span>");else{if(arguments.length<3)DateFormat=DefaultDateFormat,arguments.length<2&&(Required=!1);else if(/^(Y{2,4}(-|\/)?)?((MON)|(MM?M?)|(DD?))(-|\/)?((MON)|(MM?M?)|(DD?))((-|\/)Y{2,4})?$/i.test(DateFormat))DateFormat=DateFormat.toUpperCase();else{var AlertMessage="WARNING: The supplied date format for the '"+DateName+"' field is not valid: "+DateFormat+"\nTherefore, the default date format will be used instead: "+DefaultDateFormat;DateFormat=DefaultDateFormat;if(arguments.length==4){var CurrentDate=new storedMonthObject(DateFormat,Today.getFullYear(),Today.getMonth(),Today.getDate());AlertMessage+="\n\nThe supplied date ("+DefaultDate+") cannot be interpreted with the invalid format.\nTherefore, the current system date will be used instead: "+CurrentDate.formatted,DefaultDate=CurrentDate.formatted}alert(AlertMessage)}if(!CurrentDate)var CurrentDate=new storedMonthObject(DateFormat,Today.getFullYear(),Today.getMonth(),Today.getDate());arguments.length<4&&(DefaultDate=Required?CurrentDate.formatted:""),eval(DateName+"_Object=new calendarObject('"+DateName+"','"+DateFormat+"','"+DefaultDate+"')");if(Required||arguments.length==4)var InitialStatus="",InitialDate=eval(DateName+"_Object.picked.formatted");else{var InitialStatus=' style="visibility:hidden"',InitialDate="";eval(DateName+"_Object.setPicked("+Today.getFullYear()+","+Today.getMonth()+","+Today.getDate()+")")}with(document){writeln('<input type="hidden" name="'+DateName+'" value="'+InitialDate+'">');for(var f=0;f<forms.length;f++)for(var e=0;e<forms[f].elements.length;e++)if(typeof forms[f].elements[e].type=="string"&&forms[f].elements[e].type=="hidden"&&forms[f].elements[e].name==DateName){eval(DateName+"_Object.formNumber="+f);break}writeln('<table cellpadding="0" cellspacing="2"><tr>'+String.fromCharCode(13)+'<td valign="middle">'),writeln('<select class="calendarDateInput" id="'+DateName+'_Month_ID" onChange="'+DateName+'_Object.changeMonth(this)">');if(!Required){var NoneSelected=DefaultDate==""?" selected":"";writeln('<option value=""'+NoneSelected+">"+UnselectedMonthText+"</option>")}for(var i=0;i<12;i++)MonthSelected=DefaultDate!=""&&eval(DateName+"_Object.picked.monthIndex")==i?" selected":"",writeln('<option value="'+i+'"'+MonthSelected+">"+MonthNames[i].substr(0,3)+"</option>");writeln("</select>"+String.fromCharCode(13)+"</td>"+String.fromCharCode(13)+'<td valign="middle">'),writeln("<select"+InitialStatus+' class="calendarDateInput" id="'+DateName+'_Day_ID" onChange="'+DateName+'_Object.changeDay(this)">');for(var j=1;j<=eval(DateName+"_Object.picked.dayCount");j++)DaySelected=DefaultDate!=""&&eval(DateName+"_Object.picked.day")==j?" selected":"",writeln("<option"+DaySelected+">"+j+"</option>");writeln("</select>"+String.fromCharCode(13)+"</td>"+String.fromCharCode(13)+'<td valign="middle">'),writeln("<input"+InitialStatus+' class="calendarDateInput" type="text" id="'+DateName+'_Year_ID" size="'+eval(DateName+"_Object.picked.yearPad.length")+'" maxlength="'+eval(DateName+"_Object.picked.yearPad.length")+'" title="Year" value="'+eval(DateName+"_Object.picked.yearPad")+'" onKeyPress="return YearDigitsOnly(window.event)" onKeyUp="'+DateName+'_Object.checkYear(this)" onBlur="'+DateName+'_Object.fixYear(this)">'),write('<td valign="middle">'+String.fromCharCode(13)+"<a"+InitialStatus+' id="'+DateName+'_ID_Link" href="javascript:'+DateName+'_Object.show()" onMouseOver="return '+DateName+'_Object.iconHover(true)" onMouseOut="return '+DateName+'_Object.iconHover(false)"><img src="'+ImageURL+'" align="baseline" title="Calendar" border="0"></a>&nbsp;'),writeln('<span id="'+DateName+'_ID" style="position:absolute;visibility:hidden;width:'+CellWidth*7+"px;background-color:"+CalBGColor+';border:1px solid dimgray;" onMouseOver="'+DateName+'_Object.handleTimer(true)" onMouseOut="'+DateName+'_Object.handleTimer(false)">'),writeln('<table width="'+CellWidth*7+'" cellspacing="0" cellpadding="1">'+String.fromCharCode(13)+'<tr style="background-color:'+TopRowBGColor+';">'),writeln('<td id="'+DateName+'_Previous_ID" style="cursor:default" align="center" class="calendarDateInput" style="height:'+CellHeight+'" onClick="'+DateName+'_Object.previous.go()" onMouseDown="VirtualButton(this,true)" onMouseUp="VirtualButton(this,false)" onMouseOver="return '+DateName+'_Object.previous.hover(this,true)" onMouseOut="return '+DateName+'_Object.previous.hover(this,false)" title="'+eval(DateName+"_Object.previous.monthName")+'"><img src="'+PrevURL+'"></td>'),writeln('<td id="'+DateName+'_Current_ID" style="cursor:pointer" align="center" class="calendarDateInput" style="height:'+CellHeight+'" colspan="5" onClick="'+DateName+'_Object.displayed.goCurrent()" onMouseOver="self.status=\'Click to view '+CurrentDate.fullName+'\';return true;" onMouseOut="self.status=\'\';return true;" title="Show Current Month">'+eval(DateName+"_Object.displayed.fullName")+"</td>"),writeln('<td id="'+DateName+'_Next_ID" style="cursor:default" align="center" class="calendarDateInput" style="height:'+CellHeight+'" onClick="'+DateName+'_Object.next.go()" onMouseDown="VirtualButton(this,true)" onMouseUp="VirtualButton(this,false)" onMouseOver="return '+DateName+'_Object.next.hover(this,true)" onMouseOut="return '+DateName+'_Object.next.hover(this,false)" title="'+eval(DateName+"_Object.next.monthName")+'"><img src="'+NextURL+'"></td></tr>'+String.fromCharCode(13)+"<tr>");for(var w=0;w<7;w++)writeln('<td width="'+CellWidth+'" align="center" class="calendarDateInput" style="height:'+CellHeight+";width:"+CellWidth+';font-weight:bold;border-top:1px solid dimgray;border-bottom:1px solid dimgray;">'+WeekDays[w]+"</td>");writeln("</tr>"+String.fromCharCode(13)+"</table>"+String.fromCharCode(13)+'<span id="'+DateName+'_DayTable_ID">'+eval(DateName+"_Object.buildCalendar()")+"</span>"+String.fromCharCode(13)+"</span>"+String.fromCharCode(13)+"</td>"+String.fromCharCode(13)+"</tr>"+String.fromCharCode(13)+"</table>")}}}var DefaultDateFormat="MM/DD/YYYY",HideWait=3,Y2kPivotPoint=76,UnselectedMonthText="",FontSize=11,FontFamily="Tahoma",CellWidth=18,CellHeight=16,ImageURL="/admin/images/calendar.jpg",NextURL="/admin/images/next.gif",PrevURL="/admin/images/prev.gif",CalBGColor="white",TopRowBGColor="buttonface",DayBGColor="lightgrey",ZCounter=100,Today=new Date,WeekDays=new Array("S","M","T","W","T","F","S"),MonthDays=new Array(31,28,31,30,31,30,31,31,30,31,30,31),MonthNames=new Array("January","February","March","April","May","June","July","August","September","October","November","December");with(document)writeln("<style>"),writeln("td.calendarDateInput {letter-spacing:normal;line-height:normal;font-family:"+FontFamily+",Sans-Serif;font-size:"+FontSize+"px;}"),writeln("select.calendarDateInput {letter-spacing:.06em;font-family:Verdana,Sans-Serif;font-size:11px;}"),writeln("input.calendarDateInput {letter-spacing:.06em;font-family:Verdana,Sans-Serif;font-size:11px;}"),writeln("</style>")